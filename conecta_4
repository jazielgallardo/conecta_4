#include <iostream>
#include <vector>
#include <limits>

using namespace std;

// Constantes del juego
const int FILAS = 6;
const int COLUMNAS = 7;
const char VACIO = '.';
const char JUGADOR1 = 'X';
const char JUGADOR2 = 'O';

// Clase para manejar el juego Conecta 4
class Conecta4 {
private:
    vector<vector<char>> tablero;
    char jugadorActual;
    int fichasColocadas;

public:
    // Constructor: inicializa el tableto vacío
    Conecta4() {
        tablero.resize(FILAS, vector<char>(COLUMNAS, VACIO));
        jugadorActual = JUGADOR1;
        fichasColocadas = 0;
    }

    // Muestra tablero en consola
   void mostrarTablero() {
    cout << "\n  ";
    for (int col = 1; col <= COLUMNAS; col++) {
        cout << col << " ";
    }
    cout << "\n";
    
    for (int fila = 0; fila < FILAS; fila++) {
        cout << "| ";
        for (int col = 0; col < COLUMNAS; col++) {
            cout << tablero[fila][col] << " ";
        }
        cout << "|\n";
    }
    
    cout << "  ";
    for (int col = 0; col < COLUMNAS; col++) {
        cout << "--";
    }
    cout << "-\n";
}

// Verifica si una columna está llena
bool columnaLlena(int columna) {
    return tablero[0][columna] != VACIO;
}

//Coloca una ficha en la columna especificada
bool colocarFicha(int columna) {
    //Verifica que la columna sea válida
    if (columna < 0 || columna >= COLUMNAS) {
        return false;
    }

    //Verificar si la columna está llena
    if (columnaLlena(columna)) {
        return false;
    }

    //Buscar la fila más baja disponible.
    for (int fila = FILAS - 1; fila >= 0; fila--) {
        if (tablero[fila][columna] == VACIO) {
            tablero[fila][columna] = jugadorActual;
            fichasColocadas++;
            return true;
        }
    }

    return false;
}

//Verifica si hay 4 fichas consecutivas en horizontal
bool verificarHorizontal() {
    for (int fila = 0; fila < FILAS; fila++) {
        for (int col = 0; col <= COLUMNAS - 4; col++) {
            if (tablero[fila][col] != VACIO &&
                tablero[fila][col] == tablero[fila][col + 1] &&
                tablero[fila][col] == tablero[fila][col + 2] &&
                tablero[fila][col] == tablero[fila][col + 3]) {
                return true;
            }
        }
    }
    return false;
}

//Verficia si hay 4 fichas consecutivas en vertical
bool verificarVertical() {
    for (int col = 0; col < COLUMNAS; col++) {
        for (int fila = 0; fila <= FILAS - 4; fila++) {
            if (tablero[fila][col] != VACIO &&
                tablero[fila][col] == tablero[fila + 1][col] &&
                tablero[fila][col] == tablero[fila + 2][col] &&
                tablero[fila][col] == tablero[fila + 3][col]) {
                return true;
            }
        }
    }
    return false;
}

//Verifica diagonal ascendente
bool verificarDiagonalAscendente() {
    for (int fila = 3; fila < FILAS; fila++) {
        for (int col = 0; col <= COLUMNAS - 4; col++) {
            if (tablero[fila][col] != VACIO &&
                tablero[fila][col] == tablero[fila - 1][col + 1] &&
                tablero[fila][col] == tablero[fila - 2][col + 2] &&
                tablero[fila][col] == tablero[fila - 3][col + 3]) {
                return true;
            }
        }
    }
    return false;
}

//Verifica diagonal descendente
bool verificarDiagonalDescendente() {
    for (int fila = 0; fila <= FILAS - 4; fila++) {
        for (int col = 0; col <= COLUMNAS - 4; col++) {
            if (tablero[fila][col] != VACIO &&
                tablero[fila][col] == tablero[fila + 1][col + 1] &&
                tablero[fila][col] == tablero[fila + 2][col + 2] &&
                tablero[fila][col] == tablero[fila + 3][col + 3]) {
                return true;
            }
        }
    }
    return false;
}

bool hayGanador() {
    return verificarHorizontal() || 
           verificarVertical() || 
           verificarDiagonalAscendente() || 
           verificarDiagonalDescendente();
}


//Cambia al siguiente jugador
void cambiarTurno() {
    jugadorActual = (jugadorActual == JUGADOR1) ? JUGADOR2 : JUGADOR1;
}

//Obtiene el jugador actual
char obtenerJugadorActual() {
    return jugadorActual;
}

//Obtiene el número del jugador actual 1 o 2
int obtenerNumeroJugador() {
    return (jugadorActual == JUGADOR1) ? 1 : 2;
}

//Función principal
int main() {
    cout << "Conecta 4" << endl;
    
    Conecta4 juego;
    juego.mostrarTablero();
    
    // Prueba de colocación
    juego.colocarFicha(3);
    juego.cambiarTurno();
    juego.colocarFicha(3);
    juego.mostrarTablero();

    return 0;
}